### 项目概述

本项目旨在开发一个音频数据集管理工具，支持标准化管理音频文件及其对应的标注信息。用户可以轻松地导入、查询、修改、导出音频数据集，同时提供灵活的标注扩展、API调用、任务队列管理和权限控制功能。

### 功能需求

#### 1. **音频数据集管理**

- **数据导入与标准化**：支持读取现有音频数据集，并以标准化的方式管理。音频数据集由音频文件与标注文件组成，标注文件可能有不同格式（如JSON）。系统需要对标注信息进行解析，并转换为统一的格式，支持多种扩展字段。
  - **插件化适配层**：为每个新数据集编写适配代码，通过插件形式进行动态加载，处理不同数据集格式的导入。
  - **字段扩展**：标注信息可能包含不同的参数，如文本、发音人、语言种类等，需要支持灵活扩展新字段。

#### 2. **Web UI 管理**

- 提供图形化界面，用户可以通过搜索字段快速搜索符合条件的数据，并可以试听、修改标注信息、查看波形/频谱图等功能。
  - **数据集管理页面**：用户可以管理数据集，包括增删改查、查看数据集的详细信息（如数据条数）。
  - **数据查询页面**：支持按多种属性进行搜索和筛选，展示符合条件的数据，并提供数据修改、试听、导出等操作。
  - **属性管理页面**：管理音频数据集的属性信息，用户可以添加、删除、修改属性。
  - **属性聚合管理**：支持将多个相同数据类型的属性进行聚合，优先级可自定义。

#### 3. **音频格式转换与导出**

- **导出功能**：在导出时，支持音频文件格式转换（如MP3转换为WAV），支持调整采样率（如从48kHz转为44.1kHz）。
- 同时支持标注信息结构的自定义，用户可以选择要导出的字段。

#### 4. **API标注功能**

- 支持通过外部API（如Whisper等）对未标注的音频数据进行标注。此功能会在后期实现，因此需为未来的API集成保留扩展接口。

#### 5. **任务队列管理**

- **任务管理**：导入、导出数据集及API标注操作可能需要较长时间，系统应支持后台任务管理，避免阻塞用户操作。
  - 用户可以选择音频数据并创建标注任务，系统在后台处理任务。
  - 提供任务管理界面，用户可以查看任务进度、启动/暂停任务、查看历史任务等。

#### 6. **用户管理与权限控制**

- **用户身份验证**：系统需要提供登录功能，支持用户身份验证。
- **权限控制**：不同用户角色（如管理员、普通用户）应有不同权限，访问不同的页面和功能（如数据集导入/导出、数据修改等）。

#### 7. **日志记录与错误监控**

- 系统应记录操作日志和错误日志，以便开发人员及时发现问题并进行排查。

### 技术需求

#### 1. **后端**

- **框架**：使用 **Flask** 编写后台服务。
- **数据库**：使用 **SQLAlchemy** 和 **SQLite** 存储数据。在数据量增加后，可能迁移至 **MySQL** 或 **PostgreSQL**。
- **任务队列**：使用 **Celery** 和 **SQLite** 管理任务队列。
- **API接口**：系统应实现 **RESTful API**，便于前后端数据交互，并为未来的外部系统访问提供接口。

#### 2. **前端**

- **框架**：使用 **VUE** 和 **VITE** 创建前端项目。
- **UI组件库**：使用 **Element-plus** 组件库构建UI界面。
- **页面布局**：左侧为固定菜单栏，右侧为内容展示区。点击菜单项进入不同页面。
- **音频播放与展示**：支持音频文件的播放（试听）、标注信息的修改、波形和频谱图的展示。

#### 3. **音频处理**

- 使用 **ffmpeg-python** 实现音频文件的格式转换和采样率调整。

### 详细功能模块

#### 1. **数据集管理模块**

- **功能**：管理用户定义的多个数据集，每个数据集可以包含多个音频文件和标注信息。
- **功能点**：
  - 数据集的增删改查
  - 数据集介绍与数据条数查看
  - 用户可以选择数据集查看和管理其中的数据

#### 2. **数据导入与标准化模块**

- **功能**：支持从不同格式的标注文件中读取数据，并通过插件化的方式进行格式转换和标准化。
- **功能点**：
  - 插件机制支持扩展不同格式的数据导入
  - 自动检测并扩展标注字段，动态生成标注字段管理页面

#### 3. **数据查询模块**

- **功能**：支持通过多种属性进行音频数据的查询、筛选和管理。
- **功能点**：
  - 动态生成查询字段
  - 支持多种数据类型的查询（字符串、数值、日期等）
  - 查询结果展示，并支持数据的修改、试听和导出

#### 4. **任务管理模块**

- **功能**：管理后台任务（如数据导入、导出、标注等），用户可以查看任务状态和进度。
- **功能点**：
  - 后台异步处理长时间运行的任务
  - 查看任务进度、历史任务
  - 任务队列管理（启动、暂停）

#### 5. **API标注功能模块**

- **功能**：提供API接口，将未标注的音频文件发送到外部标注服务（如Whisper）进行标注。
- **功能点**：
  - 标注请求的发送与接收
  - 标注结果的保存与显示

#### 6. **用户管理与权限控制模块**

- **功能**：支持用户身份验证，管理不同用户角色和权限。
- **功能点**：
  - 登录功能
  - 用户角色与权限控制
  - 数据集和标注数据的访问权限控制

#### 7. **日志与错误监控模块**

- **功能**：记录系统运行日志与错误日志，以便进行调试和问题排查。
- **功能点**：
  - 日志记录（操作日志、错误日志）
  - 集成错误监控工具（如 Sentry）

### 技术栈

- **后端框架**：Flask
- **数据库**：SQLAlchemy, SQLite (迁移至 MySQL 或 PostgreSQL)
- **任务队列**：Celery
- **音频处理**：ffmpeg-python
- **前端框架**：Vue, Vite
- **UI组件库**：Element-plus
- **日志**：Flask-Logging
- **用户登录**：Flask-Login

### 未来扩展

- **API标注扩展**：将来将增加更多的标注API支持，如讯飞、百度等，支持更多音频标注方式。
- **外部系统API访问**：未来开放系统API供外部系统访问，提供数据查询、标注服务等功能。

#### 

